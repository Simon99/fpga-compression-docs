---
layout: default
title: ç®—æ³•åˆ†æ
---

# ç®—æ³•åˆ†æèˆ‡ FPGA å¯¦ç¾è€ƒé‡

## DEFLATE (gzip)

### ç®—æ³•çµæ§‹
```
DEFLATE = LZ77 + Huffman Coding
```

### LZ77 æ»‘å‹•çª—å£

| åƒæ•¸ | æ¨™æº–å€¼ | ä½å…§å­˜å€¼ | èªªæ˜ |
|------|--------|---------|------|
| wbits | 15 | 9 | çª—å£å¤§å°ä½æ•¸ |
| çª—å£å¤§å° | 32 KB | 512 B | 2^wbits |
| BRAM éœ€æ±‚ | é«˜ | **æ¥µä½** | FPGA è³‡æº |

### ç‹€æ…‹æ©Ÿè¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IDLE   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SEARCH â”‚â”€â”€â”€â”€â†’â”‚  MATCH   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â†“               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LITERAL â”‚     â”‚  ENCODE  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
             â†“
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  OUTPUT  â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### FPGA å¯¦ç¾è¦é»
- ä½¿ç”¨ Block RAM å¯¦ç¾æ»‘å‹•çª—å£
- Hash è¡¨å¯ç”¨ distributed RAM
- æµæ°´ç·šåŒ– Huffman ç·¨ç¢¼å™¨

---

## ğŸš« ç‚ºä»€éº¼ xz/zstd ä¸é©åˆ FPGAï¼Ÿ

### XZ (LZMA2) çš„å•é¡Œ

#### ç®—æ³•è¤‡é›œåº¦
- âŒ **Range Encoder** â€” éœ€è¦é«˜ç²¾åº¦é™¤æ³•é‹ç®—ï¼Œç¡¬ä»¶å¯¦ç¾æ˜‚è²´
- âŒ **è¶…å¤§å­—å…¸** â€” é»˜èª 8MBï¼Œæœ€å¤§ 1.5GBï¼Œé è¶… FPGA BRAM å®¹é‡
- âŒ **è‡ªé©æ‡‰ç·¨ç¢¼å™¨** â€” å‹•æ…‹èª¿æ•´æ¦‚ç‡åƒæ•¸ï¼Œç‹€æ…‹æ©Ÿæ¥µåº¦è¤‡é›œ
- âŒ **2304 ç¨®ç‹€æ…‹çµ„åˆ** â€” 12 Ã— 192 çš„ä¸Šä¸‹æ–‡ä¾è³´

#### è³‡æºéœ€æ±‚ä¼°ç®—
```
å…§å­˜éœ€æ±‚ï¼š  ~8MB+ï¼ˆæ»‘å‹•çª—å£ + å­—å…¸ï¼‰
é‚è¼¯å–®å…ƒï¼š  ä¼°è¨ˆ >100K LUTï¼ˆXilinx 7 ç³»åˆ—ï¼‰
æ™‚é˜é€±æœŸï¼š  å–®å€‹å¡Šå£“ç¸® >10M cycles
ä¾è³´éˆï¼š    æ¯å€‹ symbol å¿…é ˆç­‰å‰ä¸€å€‹å®Œæˆ
```

#### è‡´å‘½å•é¡Œï¼šRange Coder
```
Range Encoding æ¯æ­¥éœ€è¦ï¼š
1. é«˜ç²¾åº¦ä¹˜æ³• (32Ã—32 bit)
2. é™¤æ³•é‹ç®—ï¼ˆç¡¬ä»¶æœ€æ˜‚è²´çš„æ“ä½œï¼‰
3. æ¦‚ç‡è¡¨æ›´æ–°
4. ç‹€æ…‹è½‰ç§»

â†’ ç„¡æ³•æœ‰æ•ˆæµæ°´ç·šåŒ–
â†’ ååé‡æ¥µä½
```

---

### ZSTD çš„å•é¡Œ

#### ç®—æ³•è¤‡é›œåº¦
- âŒ **FSE (Finite State Entropy)** â€” ANS è®Šé«”ï¼Œéœ€è¦å¤§å‹ç‹€æ…‹è½‰æ›è¡¨
- âŒ **3 å¼µå‹•æ…‹ Huffman è¡¨** â€” Literal Lengths / Match Lengths / Offsets
- âŒ **åå‘è§£ç¢¼** â€” å¿…é ˆç·©è¡æ•´å€‹ block æ‰èƒ½é–‹å§‹è§£ç¢¼
- âŒ **å‹•æ…‹è¡¨ç”Ÿæˆ** â€” æ¯å€‹ block çš„ç·¨ç¢¼è¡¨éƒ½å¯èƒ½ä¸åŒ

#### è³‡æºéœ€æ±‚ä¼°ç®—
```
å…§å­˜éœ€æ±‚ï¼š  128KB+ å­—å…¸ + å¤šå¼µç·¨ç¢¼è¡¨
ç‹€æ…‹è¡¨ï¼š    æ¯å¼µ FSE è¡¨ 256-4096 entries
BRAM ç«¯å£ï¼š  éœ€è¦åŒæ™‚è¨ªå•å¤šå¼µè¡¨ï¼ˆç«¯å£ç«¶çˆ­ï¼‰
Block ç·©è¡ï¼š  éœ€è¦å®Œæ•´ block æ‰èƒ½è§£ç¢¼
```

#### è‡´å‘½å•é¡Œï¼šç„¡æ³•æµå¼è™•ç†
```
ZSTD Block çµæ§‹ï¼š
â”œâ”€â”€ Block Header
â”œâ”€â”€ Literals Section
â”‚   â”œâ”€â”€ Huffman è¡¨ï¼ˆéœ€å…ˆå®Œæ•´è®€å–ï¼‰
â”‚   â””â”€â”€ Literals æ•¸æ“š
â”œâ”€â”€ Sequences Section
â”‚   â”œâ”€â”€ 3 å¼µ FSE è¡¨ï¼ˆéœ€å…ˆå®Œæ•´è®€å–ï¼‰
â”‚   â””â”€â”€ Sequences æ•¸æ“šï¼ˆåå‘ç·¨ç¢¼ï¼‰
â””â”€â”€ å¿…é ˆè§£æå®Œæ•´ block header æ‰çŸ¥é“è¡¨çµæ§‹

â†’ ç„¡æ³•é‚Šæ”¶é‚Šè§£
â†’ éœ€è¦å¤§ç·©è¡å€
â†’ å»¶é²é«˜
```

---

### å°æ¯”ç¸½çµ

| ç‰¹æ€§ | gzip (wbits=9) | xz (LZMA2) | zstd |
|------|---------------|------------|------|
| å­—å…¸å¤§å° | **512 B** | 8+ MB | 128+ KB |
| ç‹€æ…‹æ•¸ | ~10 | ~2300 | ~1000 |
| ç·¨ç¢¼æ–¹å¼ | Huffman | Range | FSE |
| ç¡¬ä»¶é™¤æ³• | ä¸éœ€è¦ | **éœ€è¦** | ä¸éœ€è¦ |
| æµå¼è™•ç† | âœ… å¯ä»¥ | âš ï¸ å›°é›£ | âŒ ä¸è¡Œ |
| å‹•æ…‹è¡¨ | å›ºå®š | è‡ªé©æ‡‰ | **æ¯ block è®Š** |
| å…¸å‹ FPGA | å…¥é–€ç´šå¯å¯¦ç¾ | é«˜ç«¯éƒ½å›°é›£ | ä¸­é«˜ç«¯å›°é›£ |
| **çµè«–** | âœ… æ¨è–¦ | âŒ ä¸é©ç”¨ | âŒ ä¸é©ç”¨ |

> **æ ¸å¿ƒè§€é»ï¼š** ç¾ä»£å£“ç¸®ç®—æ³•è¿½æ±‚çš„æ˜¯ CPU ä¸Šçš„å£“ç¸®ç‡/é€Ÿåº¦å¹³è¡¡ï¼Œ
> è€Œéç¡¬ä»¶å‹å¥½æ€§ã€‚DEFLATE é›–ç„¶ã€Œè€ã€ï¼Œä½†å…¶ç°¡å–®çš„ LZ77+Huffman çµæ§‹
> æ°å¥½é©åˆ FPGA çš„ä¸¦è¡Œæµæ°´ç·šæ¶æ§‹ã€‚

---

## AES

### ç®—æ³•çµæ§‹
```
AES-128: 10 è¼ª
AES-256: 14 è¼ª

æ¯è¼ª:
  SubBytes â†’ ShiftRows â†’ MixColumns â†’ AddRoundKey
```

### S-Box å¯¦ç¾

| æ–¹å¼ | è³‡æº | é€Ÿåº¦ |
|------|------|------|
| æŸ¥è¡¨ (LUT) | 256 entries | 1 cycle |
| çµ„åˆé‚è¼¯ | è¼ƒå¤š LUT | 1 cycle |
| åˆ†æ™‚å…±äº« | è¼ƒå°‘ | å¤š cycles |

### FPGA å¯¦ç¾è¦é»
- S-Box ç”¨ Block RAM æˆ– LUT
- å¯å±•é–‹æ‰€æœ‰è¼ªæ¬¡ï¼ˆé«˜ååï¼‰
- æˆ–ç”¨å–®è¼ªé‡è¤‡ï¼ˆçœè³‡æºï¼‰

### åƒè€ƒå¯¦ç¾
- [secworks/aes](https://github.com/secworks/aes) â€” å®Œæ•´ Verilog

---

## RSA

### ç®—æ³•çµæ§‹
```
åŠ å¯†: C = M^e mod n
è§£å¯†: M = C^d mod n
```

### æ ¸å¿ƒé‹ç®—
- **Montgomery ä¹˜æ³•** â€” æ¨¡ä¹˜å„ªåŒ–
- **æ¨¡æŒ‡æ•¸é‹ç®—** â€” å¹³æ–¹-ä¹˜æ³•ç®—æ³•

### FPGA å¯¦ç¾é›£åº¦ï¼šé«˜

| æŒ‘æˆ° | åŸå›  |
|------|------|
| å¤§æ•¸é‹ç®— | 2048-bit ä¹˜æ³•å™¨ |
| è³‡æºæ¶ˆè€— | DSP/BRAM éœ€æ±‚é«˜ |
| æ™‚åºæ”¶æ–‚ | é•·é€²ä½éˆ |

### å»ºè­°
- ä½¿ç”¨ HLS å·¥å…· (Vitis HLS)
- æˆ–åªå¯¦ç¾ Montgomery ä¹˜æ³•å™¨
- è€ƒæ…®ä½¿ç”¨ FPGA ä¾›æ‡‰å•† IP

---

## å·¥å…·éˆ

### é–‹æºä»¿çœŸ
```bash
# å®‰è£
sudo apt install verilator iverilog gtkwave

# ä»¿çœŸ
iverilog -o sim top.v testbench.v
vvp sim
gtkwave dump.vcd
```

### HLS å·¥å…·

| å·¥å…· | é©ç”¨ | æˆæ¬Š |
|------|------|------|
| Vitis HLS | Xilinx FPGA | å…è²»ç‰ˆå¯ç”¨ |
| Intel HLS | Intel FPGA | Quartus å…§å»º |
| Bambu | é€šç”¨ | é–‹æº |

---

## åƒè€ƒè³‡æº

### è«–æ–‡
- *A High-Performance FPGA-Based Implementation of the DEFLATE Compression Algorithm*
- *Efficient Hardware Implementation of AES*

### é–‹æºé …ç›®
- [ZipCPU/gzip-fpga](https://github.com/ZipCPU/gzip-fpga)
- [secworks/aes](https://github.com/secworks/aes)
- [ultraembedded/rsa](https://github.com/ultraembedded/rsa)

---

[â† è¿”å›é¦–é ](index.html)

*æœ€å¾Œæ›´æ–°: 2026-02-14*
